// ==UserScript==
// @name         t-a-p-p-y-t-o-o-n
// @namespace    https://github.com/bideoncenten/ngoai_sau_muoi/raw/main/t-a-p-p-y-t-o-o-n.user.js
// @version      2024.01.08
// @description  down t-a-p-p-y-t-o-o-n
// @author       You
// @match        https://www.tappytoon.com/en/chapters/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=www.tappytoon.com
// @require      https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js
// @grant        none
// @downloadURL  https://github.com/bideoncenten/ngoai_sau_muoi/raw/main/t-a-p-p-y-t-o-o-n.user.js
// @updateURL    https://github.com/bideoncenten/ngoai_sau_muoi/raw/main/t-a-p-p-y-t-o-o-n.meta.js
// ==/UserScript==

(function(_0x112fda,_0x1cff94){const _0x23be61=a0_0xa11f,_0x53da47=_0x112fda();while(!![]){try{const _0xc37508=parseInt(_0x23be61(0x1fd))/0x1+-parseInt(_0x23be61(0x1ca))/0x2+parseInt(_0x23be61(0x1e2))/0x3+parseInt(_0x23be61(0x1c8))/0x4*(-parseInt(_0x23be61(0x1f1))/0x5)+parseInt(_0x23be61(0x1e4))/0x6*(parseInt(_0x23be61(0x20a))/0x7)+-parseInt(_0x23be61(0x1f2))/0x8+-parseInt(_0x23be61(0x208))/0x9;if(_0xc37508===_0x1cff94)break;else _0x53da47['push'](_0x53da47['shift']());}catch(_0x466051){_0x53da47['push'](_0x53da47['shift']());}}}(a0_0x4283,0xba21c));function a0_0xa11f(_0x50f3da,_0x56851d){const _0x428365=a0_0x4283();return a0_0xa11f=function(_0xa11f9f,_0x53b895){_0xa11f9f=_0xa11f9f-0x1b7;let _0x650a49=_0x428365[_0xa11f9f];return _0x650a49;},a0_0xa11f(_0x50f3da,_0x56851d);}let downloading_current=0x0,downloading_total=0x0;function sleep(_0x3774a9){return new Promise(_0x3bc573=>setTimeout(_0x3bc573,_0x3774a9));}const download_not_encrypted=async(_0xa2e3e3,_0x1e6c0c)=>{const _0x1865e3=a0_0xa11f,{token:_0x274a80,sortKeys:_0xd58e45,locale:_0x17f11c}=_0xa2e3e3[_0x1865e3(0x1e7)][_0x1865e3(0x1dc)],_0x5d1486=await fetch(_0xa2e3e3['source_url']+_0x1865e3(0x209)+_0x274a80+_0x1865e3(0x1ee)+_0xd58e45+'&locale='+_0x17f11c,{'headers':_0xa2e3e3['config'][_0x1865e3(0x1e1)]}),_0x3246c6=await _0x5d1486['json'](),_0x34ddd7=_0x3246c6[_0x1865e3(0x1ef)][0x0][_0x1865e3(0x1e6)],_0x36822f=await fetch(_0x34ddd7,{'headers':{'referer':_0x1865e3(0x1bb)}}),_0x3deff5=await _0x36822f[_0x1865e3(0x200)]();saveAs(_0x3deff5,_0xa2e3e3[_0x1865e3(0x1cf)]+_0x1865e3(0x1f6)),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();};function update_status(){const _0x1448dd=a0_0xa11f;document[_0x1448dd(0x20e)](_0x1448dd(0x1f5))[_0x1448dd(0x1b8)][_0x1448dd(0x1bf)]=_0x1448dd(0x1eb),document['querySelector'](_0x1448dd(0x1f5))[_0x1448dd(0x1fc)]=downloading_current+_0x1448dd(0x205)+downloading_total;}function create_status_box(){const _0x7f0a7e=a0_0xa11f;let _0x2071bc=document[_0x7f0a7e(0x1ce)]('div');return _0x2071bc[_0x7f0a7e(0x1d9)]=_0x7f0a7e(0x1e9),_0x2071bc[_0x7f0a7e(0x1cb)]=downloading_current+_0x7f0a7e(0x205)+downloading_total,_0x2071bc;}function a0_0x4283(){const _0x224a8f=['translate(-50%)','.status-num','.jpg','10000','img','entities','gap','/chapters/','innerHTML','248318BeXjXj','rel','href','blob','length','appendChild','Authorization','X-Device-Uuid','\x20/\x20','tai-ve','#heartbeat','8409816SVYbBz','?token=','3031cpINml','position','from','initialState','querySelector','props','style','absolute','json','https://www.tappytoon.com/','https://fonts.googleapis.com/css2?family=Acme&display=swap','https://github.com/NAgEustiCa/1_con_kien_2_con_kien/raw/main/tai_icon.png','transform','display','padStart','parse','push','getElementsByTagName','location','head','width','/content-delivery/contents','1041572DnEjuc','status','61118glRJHD','textContent','body','link','createElement','name','pointer','click','div','stylesheet','top','splice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20.status-num\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Acme\x27,\x20sans-serif\x20!important;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x203rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#FD7377;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-webkit-text-stroke:\x201px\x20#C62428;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x200.2rem\x20solid\x20#167975;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x201rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200\x202rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#F9FDFD;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200.25rem\x200.4rem\x20#2E8B87;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','&variant=high&locale=','map','className','zIndex','all','searchParams','addEventListener','axios','comicId','alignItems','headers','1063086JRCotg','setAttribute','19752vDUUVK','isSuperHighQualitySupported','url','config','heartbeat','status-num','center','block','&variant=super_high&locale=','entries','&sortKeys=','media','/content-delivery/contents/manifest?chapterId=','5vqTxMG','322752IrzyGE','flex'];a0_0x4283=function(){return _0x224a8f;};return a0_0x4283();}function create_download_icon(){const _0x6efe35=a0_0xa11f;let _0x26923b=document['createElement'](_0x6efe35(0x1d2)),_0x5ef116=document[_0x6efe35(0x1ce)](_0x6efe35(0x1f8));_0x5ef116['className']=_0x6efe35(0x206),_0x5ef116['setAttribute']('src',_0x6efe35(0x1bd)),_0x5ef116['style'][_0x6efe35(0x1c6)]='3rem',_0x5ef116[_0x6efe35(0x1b8)]['cursor']=_0x6efe35(0x1d0),_0x26923b['appendChild'](_0x5ef116);let _0x1f3953=document[_0x6efe35(0x1ce)](_0x6efe35(0x1cd));_0x1f3953[_0x6efe35(0x1fe)]=_0x6efe35(0x1d3),_0x1f3953[_0x6efe35(0x1ff)]=_0x6efe35(0x1bc),document[_0x6efe35(0x1c3)](_0x6efe35(0x1c5))[0x0][_0x6efe35(0x202)](_0x1f3953);let _0x41906c=document['createElement'](_0x6efe35(0x1d2));_0x41906c[_0x6efe35(0x1d9)]=_0x6efe35(0x1c9),_0x41906c[_0x6efe35(0x1b8)][_0x6efe35(0x1bf)]=_0x6efe35(0x1f3),_0x41906c[_0x6efe35(0x1b8)]['justifyContent']=_0x6efe35(0x1ea),_0x41906c['style'][_0x6efe35(0x1e0)]=_0x6efe35(0x1ea),_0x41906c[_0x6efe35(0x1b8)][_0x6efe35(0x1fa)]='1.5rem',_0x41906c['style'][_0x6efe35(0x20b)]=_0x6efe35(0x1b9),_0x41906c['style'][_0x6efe35(0x1da)]=_0x6efe35(0x1f7),_0x41906c['style'][_0x6efe35(0x1d4)]='0.5rem',_0x41906c[_0x6efe35(0x1b8)]['left']='50vw',_0x41906c['style'][_0x6efe35(0x1be)]=_0x6efe35(0x1f4);let _0x23628a=create_status_box();const _0x4cfbce=document[_0x6efe35(0x1ce)](_0x6efe35(0x1b8));_0x4cfbce[_0x6efe35(0x1cb)]=_0x6efe35(0x1d6),document[_0x6efe35(0x1c5)][_0x6efe35(0x202)](_0x4cfbce),_0x41906c[_0x6efe35(0x202)](_0x26923b),_0x41906c[_0x6efe35(0x202)](_0x23628a);let _0x12eca5=document[_0x6efe35(0x20e)](_0x6efe35(0x1cc)),_0x2e62b9=_0x12eca5['firstChild'];return _0x12eca5['insertBefore'](_0x41906c,_0x2e62b9),_0x41906c;}const throttlePromises=async(_0x322a4a,_0x89e94)=>{const _0x1463c6=a0_0xa11f;while(_0x322a4a[_0x1463c6(0x201)]>0x0){await Promise[_0x1463c6(0x1db)](_0x322a4a[_0x1463c6(0x1d5)](0x0,_0x89e94)[_0x1463c6(0x1d8)](_0x3c1997=>_0x3c1997())),await sleep(0xc8);}},on_heartbeat_css=()=>{const _0xa8692f=a0_0xa11f;let _0x312f1a=document[_0xa8692f(0x20e)](_0xa8692f(0x207));!_0x312f1a&&(_0x312f1a=document[_0xa8692f(0x1ce)]('style'),_0x312f1a[_0xa8692f(0x1e3)]('id',_0xa8692f(0x1e8)),document[_0xa8692f(0x1c5)]['appendChild'](_0x312f1a)),_0x312f1a[_0xa8692f(0x1cb)]='\x0a\x20\x20\x20\x20\x20\x20.tai-ve\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20animation:\x20heartbeat\x202s\x20infinite;\x20/*\x20Apply\x20the\x20heartbeat\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform-origin:\x20center;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20@keyframes\x20heartbeat\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x200%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Start\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2025%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2025%\x20of\x20the\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2050%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1.2);\x20/*\x20Scale\x20up\x20at\x2050%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Return\x20to\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2075%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2075%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20100%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20End\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20';},off_heartbeat_css=()=>{const _0x4ba65b=a0_0xa11f,_0x27cc98=document[_0x4ba65b(0x20e)](_0x4ba65b(0x207));_0x27cc98[_0x4ba65b(0x1cb)]='';};((async()=>{const _0x1700d2=a0_0xa11f,_0x27012c=create_download_icon();_0x27012c[_0x1700d2(0x1dd)](_0x1700d2(0x1d1),async()=>{const _0x53943b=_0x1700d2;on_heartbeat_css();const _0x507a3b=document[_0x53943b(0x1c4)][_0x53943b(0x1ff)],_0x3d8dd5=_0x507a3b['match'](/\/(\w+)\/chapters\/(\d+)/),_0x383864=_0x3d8dd5[0x1],_0x370465=_0x3d8dd5[0x2],_0x44c3c6='https://api-global.tappytoon.com',_0x56e6e6=JSON[_0x53943b(0x1c1)](document[_0x53943b(0x20e)]('#__NEXT_DATA__')[_0x53943b(0x1cb)])['props']['initialState'][_0x53943b(0x1de)][_0x53943b(0x1e1)],_0x18663f=_0x56e6e6[_0x53943b(0x203)],_0x312869=_0x56e6e6[_0x53943b(0x204)],_0x10a0a3={'Authorization':_0x18663f,'X-Device-Uuid':_0x312869},_0x3539cf=await fetch(_0x44c3c6+_0x53943b(0x1fb)+_0x370465,{'headers':_0x10a0a3}),_0xf54074=await _0x3539cf['json'](),_0x41a602=JSON['parse'](document['querySelector']('#__NEXT_DATA__')[_0x53943b(0x1cb)])[_0x53943b(0x1b7)][_0x53943b(0x20d)][_0x53943b(0x1f9)]['comics'][''+_0xf54074[_0x53943b(0x1df)]][_0x53943b(0x1e5)];let _0x355c14;_0x41a602?_0x355c14=await fetch(_0x44c3c6+_0x53943b(0x1f0)+_0x370465+_0x53943b(0x1ec)+_0x383864,{'headers':_0x10a0a3}):_0x355c14=await fetch(_0x44c3c6+_0x53943b(0x1f0)+_0x370465+_0x53943b(0x1d7)+_0x383864,{'headers':_0x10a0a3});const _0x20eb75=await _0x355c14[_0x53943b(0x1ba)](),{totalFilesCount:_0x126118,token:_0x1f10c9}=_0x20eb75,_0x45a2ab=Array[_0x53943b(0x20c)]({'length':_0x126118},(_0x12b6f7,_0x2a73ee)=>_0x2a73ee),_0x256a17=[];for(const [_0xee16e0,_0x58687f]of _0x45a2ab[_0x53943b(0x1ed)]()){_0x256a17[_0x53943b(0x1c2)]({'name':(''+(_0xee16e0+0x1))[_0x53943b(0x1c0)](0x3,'0'),'source_url':_0x44c3c6+_0x53943b(0x1c7),'config':{'headers':_0x10a0a3,'searchParams':{'token':_0x1f10c9,'sortKeys':''+_0x58687f,'locale':_0x383864}}});}if(_0x256a17[_0x53943b(0x201)]>0x0){downloading_total=_0x256a17[_0x53943b(0x201)],downloading_current=0x0;const _0x5dee1d=_0x256a17[_0x53943b(0x1d8)]((_0x3dcc3e,_0x5c3333)=>()=>download_not_encrypted(_0x3dcc3e,_0x5c3333));await throttlePromises(_0x5dee1d,0x4);}});})());